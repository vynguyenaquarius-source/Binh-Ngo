<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Happy New Year My Star üåü</title>
    <style>
        body { margin: 0; background-color: #000; overflow: hidden; font-family: 'Arial', sans-serif; touch-action: manipulation; }
        canvas { display: block; }
        
        #overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.95); display: flex; justify-content: center;
            align-items: center; z-index: 1000; color: white;
        }

        #startBtn {
            padding: 15px 40px; font-size: 1.2rem; background: transparent;
            color: #ffd700; border: 2px solid #ffd700; border-radius: 50px;
            cursor: pointer; font-weight: bold; text-transform: uppercase;
        }

        .text-container {
            position: absolute; top: 25%; left: 50%;
            transform: translate(-50%, -50%); text-align: center;
            z-index: 10; width: 100%; pointer-events: none;
            transition: opacity 2s ease-in-out; opacity: 0; display: none;
        }

        h1 {
            color: #fff; font-size: 10vw; text-transform: uppercase;
            letter-spacing: 2px; text-shadow: 0 0 15px #fff, 0 0 30px #ffd700;
            line-height: 1.3; margin: 0;
        }

        @media (min-width: 768px) { h1 { font-size: 3.5rem; } }

        /* ƒêI·ªÄU CH·ªàNH D√íNG CH·ªÆ CU·ªêI CAO H∆†N */
        #finalMessage {
            position: absolute; 
            bottom: -200px; /* V·ªã tr√≠ b·∫Øt ƒë·∫ßu d∆∞·ªõi m√†n h√¨nh */
            left: 50%;
            transform: translateX(-50%); 
            width: 90%; 
            text-align: center;
            color: #ffd700; 
            font-size: 1.3rem; 
            font-style: italic;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.8);
            opacity: 0; 
            z-index: 15; 
            pointer-events: none; 
            line-height: 1.6;
        }

        .show-final {
            transition: opacity 3s ease-in-out, transform 12s cubic-bezier(0.1, 0.5, 0.2, 1);
            opacity: 1 !important;
            /* Thay ƒë·ªïi t·ª´ -400px th√†nh -500px ƒë·ªÉ ƒë·∫©y ch·ªØ l√™n cao h∆°n n·ªØa */
            transform: translate(-50%, -500px) !important; 
        }
    </style>
</head>
<body>

    <div id="overlay">
        <button id="startBtn">CH·∫†M ƒê·ªÇ B·∫ÆT ƒê·∫¶U ‚ú®</button>
    </div>

    <audio id="bgMusic" loop preload="auto" playsinline>
        <source src="HPNY.mp3" type="audio/mpeg">
        <source src="hpny.mp3" type="audio/mpeg">
    </audio>

    <div class="text-container" id="textMain">
        <h1>HAPPY NEW YEAR<br>MY STAR ‚ú®</h1>
    </div>

    <div id="finalMessage">
        "Ng√¥i sao ∆°i, m·ªôt nƒÉm m·ªõi m·ªôt h√†nh tr√¨nh m·ªõi,<br>h√£y to·∫£ s√°ng r·ª±c r·ª° nh·∫•t nh√©"
    </div>
    
    <canvas id="canvas"></canvas>
<script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const music = document.getElementById('bgMusic');
        const startBtn = document.getElementById('startBtn');
        const overlay = document.getElementById('overlay');
        const textMain = document.getElementById('textMain');
        const finalMessage = document.getElementById('finalMessage');

        // H√†m ph√°t nh·∫°c "c∆∞·ª°ng b·ª©c" cho Mobile
        function forcePlay() {
            music.volume = 1.0;
            const playPromise = music.play();
            if (playPromise !== undefined) {
                playPromise.catch(() => {
                    // N·∫øu l·ªói, th·ª≠ l·∫°i khi ng∆∞·ªùi d√πng ch·∫°m v√†o b·∫•t c·ª© ƒë√¢u
                    document.addEventListener('touchstart', () => music.play(), { once: true });
                });
            }
        }

        let stars = [], buildings = [], fireworks = [], particles = [];
        let fireworkCount = 0;
        let activeInterval;

        function resize() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            initBuildings();
        }
        window.addEventListener('resize', resize);

        function initBuildings() {
            buildings = [];
            const spacing = window.innerWidth < 600 ? 55 : 85;
            for (let i = 0; i < window.innerWidth; i += spacing) {
                let h = Math.random() * 100 + 60;
                let b = { x: i, w: spacing - 8, h: h, windows: [] };
                for (let wy = window.innerHeight - h + 15; wy < window.innerHeight - 10; wy += 18) {
                    for (let wx = i + 10; wx < i + spacing - 15; wx += 12) {
                        b.windows.push({x: wx, y: wy, on: Math.random() > 0.4});
                    }
                }
                buildings.push(b);
            }
        }

        function drawScene() {
            stars.forEach(s => {
                s.opacity += s.speed;
                if (s.opacity > 1 || s.opacity < 0.2) s.speed = -s.speed;
                ctx.fillStyle = `rgba(255, 255, 255, ${s.opacity})`;
                ctx.beginPath(); ctx.arc(s.x, s.y, s.size, 0, Math.PI * 2); ctx.fill();
            });
            buildings.forEach(b => {
                ctx.fillStyle = "#0a0a14";
                ctx.fillRect(b.x, canvas.height - b.h, b.w, b.h);
                b.windows.forEach(w => {
                    ctx.fillStyle = w.on ? "#ffd700" : "#1a1a2e";
                    if (Math.random() > 0.998) w.on = !w.on;
                    ctx.fillRect(w.x, w.y, 4, 7);
                });
            });
        }

        class Firework {
            constructor(x, isSpecial = false) {
                this.x = x || Math.random() * canvas.width;
                this.y = canvas.height;
                this.targetY = Math.random() * (canvas.height * 0.45);
                this.speed = 4;
this.color = isSpecial ? "#ffd700" : `hsl(${Math.random() * 360}, 100%, 65%)`;
                this.isSpecial = isSpecial;
                this.dead = false;
            }
            update() { this.y -= this.speed; if (this.y <= this.targetY) this.dead = true; }
            draw() {
                ctx.beginPath(); ctx.arc(this.x, this.y, 2.5, 0, Math.PI * 2);
                ctx.fillStyle = this.color; ctx.fill();
            }
        }

        class Particle {
            constructor(x, y, color, angle, speed, isGold = false) {
                this.x = x; this.y = y; this.color = color;
                this.angle = angle; this.speed = speed;
                this.friction = 0.96; this.gravity = 0.08;
                this.alpha = 1;
                this.decay = isGold ? 0.005 : 0.012;
            }
            update() {
                this.speed *= this.friction;
                this.x += Math.cos(this.angle) * this.speed;
                this.y += Math.sin(this.angle) * this.speed + this.gravity;
                this.alpha -= this.decay;
            }
            draw() {
                if (Math.random() > 0.1) {
                    ctx.globalAlpha = this.alpha; ctx.fillStyle = this.color;
                    ctx.beginPath(); ctx.arc(this.x, this.y, 1.2, 0, Math.PI * 2); ctx.fill();
                }
            }
        }

        function createStarExplosion(x, y) {
            const points = 5;
            for (let i = 0; i < 150; i++) {
                let angle = (i / 150) * Math.PI * 2;
                let mod = (i / 150) * points;
                let s = Math.abs(Math.sin(mod * Math.PI));
                let speed = 2 + (1 - s) * 5; 
                particles.push(new Particle(x, y, "#ffd700", angle, speed, true));
            }
        }

        function loop() {
            ctx.globalAlpha = 1;
            ctx.fillStyle = 'rgba(0, 0, 0, 0.2)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            drawScene();
            fireworks.forEach((fw, i) => {
                fw.update(); fw.draw();
                if (fw.dead) {
                    if (fw.isSpecial) createStarExplosion(fw.x, fw.y);
                    else for (let j = 0; j < 80; j++) particles.push(new Particle(fw.x, fw.y, fw.color, Math.random() * Math.PI * 2, Math.random() * 5 + 1));
                    fireworks.splice(i, 1);
                }
            });
            particles.forEach((p, i) => {
                p.update(); p.draw();
                if (p.alpha <= 0) particles.splice(i, 1);
            });
            requestAnimationFrame(loop);
        }

        function grandFinale() {
            clearInterval(activeInterval);
            for(let i=0; i<35; i++) {
                setTimeout(() => {
                    fireworks.push(new Firework(Math.random()*canvas.width, Math.random()>0.6));
                }, i * 110);
            }
        }

        resize();
        for (let i = 0; i < 120; i++) {
stars.push({
                x: Math.random() * window.innerWidth,
                y: Math.random() * window.innerHeight * 0.8,
                size: Math.random() * 1.2,
                opacity: Math.random(),
                speed: Math.random() * 0.03 + 0.01
            });
        }

        startBtn.onclick = () => {
            overlay.style.display = 'none';
            textMain.style.display = 'block';
            setTimeout(() => textMain.style.opacity = '1', 100);
            
            // √âp nh·∫°c ph√°t
            forcePlay();
            
            activeInterval = setInterval(() => {
                fireworkCount++;
                fireworks.push(new Firework(null, fireworkCount % 4 === 0));
            }, 700);

            setTimeout(() => { textMain.style.opacity = '0'; }, 8000);
            setTimeout(() => { finalMessage.classList.add('show-final'); }, 10000);
            setTimeout(() => { grandFinale(); }, 35000);
            setTimeout(() => { location.reload(); }, 42000);
            loop();
        };
    </script>
</body>
</html>
